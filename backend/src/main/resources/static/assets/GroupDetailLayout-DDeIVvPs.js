import{d as j,j as e,e as N,L as v,f as B,g as P,z as w,r as k,u as I,a as M,h as J,B as y,I as f,i as O,k as W,l as Y,m as ee,b as se}from"./index-D49t0lQR.js";import{c as F,d as T,C as m,b as x,e as g,E as A,f as te,P as L,U as ae,X as R}from"./EmptyState-B8uy_Cys.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=j("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=j("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=j("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=j("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=j("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=j("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);function ce({tabs:s,activeTab:t,onTabChange:a}){return e.jsxs("div",{children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:s.map(n=>e.jsx("button",{onClick:()=>a(n.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${t===n.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,"aria-current":t===n.id?"page":void 0,children:n.label},n.id))})}),e.jsx("div",{className:"py-6",children:s.find(n=>n.id===t)?.content})]})}function G(s){return F({queryKey:["balances",s],queryFn:async()=>(await N.get(`/api/balances/${s}`)).data,enabled:!!s})}function C(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)}function oe({groupId:s}){const{data:t,isLoading:a}=G(s),{data:n,isLoading:c}=T(s);if(a||c)return e.jsx(v,{className:"py-12"});if(!t||!n)return e.jsx(m,{children:e.jsx(x,{children:e.jsx("p",{className:"text-center text-red-600",children:"Failed to load balances"})})});if(t.totals.length===0)return e.jsxs(m,{children:[e.jsx(g,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Balances"})}),e.jsx(x,{children:e.jsx(A,{icon:e.jsx(de,{size:32}),title:"No balances yet",description:"Add expenses to see who owes what"})})]});const d=r=>{const l=n.members.find(i=>i.id===r);return l?.name||l?.email||"Unknown"};return e.jsxs(m,{children:[e.jsx(g,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Balances"})}),e.jsxs(x,{children:[e.jsx("div",{className:"space-y-3",children:t.totals.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:d(r.userId)}),e.jsxs("span",{className:`text-lg font-semibold ${r.balance>0?"text-green-600 dark:text-green-400":r.balance<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:[r.balance>0?"+":"",C(r.balance)]})]},r.userId))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Tip:"})," Positive balances indicate money owed to the person. Negative balances indicate money the person owes."]})})]})]})}function K(s){return F({queryKey:["expenses",s],queryFn:async()=>(await N.get("/api/expenses",{params:{groupId:s}})).data,enabled:!!s})}function me(){const s=B();return P({mutationFn:async t=>(await N.post("/api/expenses",t)).data,onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["expenses",a.groupId]}),s.invalidateQueries({queryKey:["balances",a.groupId]}),w.success("Expense added successfully")},onError:t=>{w.error(t.response?.data?.message||"Failed to add expense")}})}function xe({groupId:s}){const{data:t,isLoading:a}=G(s),{data:n,isLoading:c}=K(s);if(a||c)return e.jsx(v,{className:"py-12"});const d=n?.reduce((l,i)=>l+i.amount,0)||0,r=n?.length||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"mr-2 h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Total Expenses"})]})}),e.jsxs(x,{children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:C(d)}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[r," ",r===1?"expense":"expenses"]})]})]}),e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"mr-2 h-5 w-5 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Active Members"})]})}),e.jsxs(x,{children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:t?.totals.length||0}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"members with balances"})]})]})]}),e.jsx(oe,{groupId:s})]})}function ue({group:s}){const[t,a]=k.useState(!1),n=te(),{register:c,handleSubmit:d,reset:r,formState:{errors:l}}=I({resolver:M(J)}),i=async h=>{await n.mutateAsync({groupId:s.id,email:h.email}),r(),a(!1)};return e.jsx("div",{className:"space-y-6",children:e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Group Members"}),e.jsxs(y,{size:"sm",onClick:()=>a(!t),children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Add Member"]})]})}),e.jsxs(x,{children:[t&&e.jsx("form",{onSubmit:d(i),className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{placeholder:"member@example.com",error:l.email?.message,...c("email")}),e.jsx(y,{type:"submit",loading:n.isPending,children:"Add"}),e.jsx(y,{type:"button",variant:"secondary",onClick:()=>{r(),a(!1)},children:"Cancel"})]})}),s.members.length===0?e.jsx(A,{icon:e.jsx(ae,{size:32}),title:"No members yet",description:"Add members to start splitting expenses"}):e.jsx("div",{className:"space-y-2",children:s.members.map(h=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:h.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:h.email})]})},h.id))})]})]})})}const S=k.forwardRef(({className:s="",label:t,error:a,options:n,id:c,...d},r)=>{const l=c||t?.toLowerCase().replace(/\s+/g,"-");return e.jsxs("div",{className:"w-full",children:[t&&e.jsx("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsx("select",{ref:r,id:l,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed ${a?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 ${s}`,"aria-invalid":a?"true":"false","aria-describedby":a?`${l}-error`:void 0,...d,children:n.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),a&&e.jsx("p",{id:`${l}-error`,className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a})]})});S.displayName="Select";function he({checked:s,onChange:t,label:a}){return e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:s,onChange:n=>t(n.target.checked)}),e.jsx("div",{className:`block w-14 h-8 rounded-full transition-colors ${s?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx("div",{className:`absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${s?"transform translate-x-6":""}`})]}),a&&e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-100",children:a})]})}function pe({groupId:s,group:t,isOpen:a,onToggle:n,onSuccess:c}){const[d,r]=k.useState(!0),l=me(),{register:i,handleSubmit:h,control:U,watch:u,setValue:E,reset:Q,formState:{errors:b}}=I({resolver:M(O),defaultValues:{description:"",amount:0,paidByUserId:t.members[0]?.id||"",shares:t.members.map(o=>({userId:o.id,amount:0}))}}),{fields:H}=W({control:U,name:"shares"}),q=u("amount"),V=o=>{if(r(o),o&&q>0){const p=q/t.members.length;t.members.forEach(($,z)=>{E(`shares.${z}.amount`,parseFloat(p.toFixed(2)))})}},_=o=>{const p=parseFloat(o.target.value)||0;if(E("amount",p),d&&p>0){const $=p/t.members.length;t.members.forEach((z,X)=>{E(`shares.${X}.amount`,parseFloat($.toFixed(2)))})}},Z=async o=>{await l.mutateAsync({groupId:s,description:o.description,amount:o.amount,paidByUserId:o.paidByUserId,shares:o.shares}),Q(),c()};return e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Expenses"}),e.jsxs(y,{size:"sm",onClick:n,children:[a?e.jsx(R,{className:"mr-2 h-4 w-4"}):e.jsx(L,{className:"mr-2 h-4 w-4"}),a?"Cancel":"Add Expense"]})]})}),a&&e.jsx(x,{children:e.jsxs("form",{onSubmit:h(Z),className:"space-y-4",children:[e.jsx(f,{label:"Description",placeholder:"e.g., Dinner at restaurant",error:b.description?.message,...i("description")}),e.jsx(f,{label:"Amount",type:"number",step:"0.01",placeholder:"0.00",error:b.amount?.message,...i("amount",{valueAsNumber:!0}),onChange:_}),e.jsx(S,{label:"Paid by",options:t.members.map(o=>({value:o.id,label:o.name||o.email})),error:b.paidByUserId?.message,...i("paidByUserId")}),e.jsx("div",{children:e.jsx(he,{checked:d,onChange:V,label:"Split equally"})}),!d&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Custom shares"}),H.map((o,p)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 min-w-[120px]",children:t.members[p]?.name||t.members[p]?.email}),e.jsx(f,{type:"number",step:"0.01",placeholder:"0.00",...i(`shares.${p}.amount`,{valueAsNumber:!0})}),e.jsx("input",{type:"hidden",...i(`shares.${p}.userId`)})]},o.id)),b.shares&&e.jsx("p",{className:"text-sm text-red-600",children:b.shares.message})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(y,{type:"submit",loading:l.isPending,children:"Add Expense"})]})]})})]})}function ye({groupId:s,group:t}){const{data:a,isLoading:n,error:c}=K(s);if(n)return e.jsx(v,{className:"py-12"});if(c)return e.jsx(m,{children:e.jsx(x,{children:e.jsx("p",{className:"text-center text-red-600",children:"Failed to load expenses"})})});if(!a||a.length===0)return e.jsx(m,{children:e.jsx(x,{children:e.jsx(A,{icon:e.jsx(D,{size:32}),title:"No expenses yet",description:"Add your first expense to start tracking"})})});const d=r=>{const l=t.members.find(i=>i.id===r);return l?.name||l?.email||"Unknown"};return e.jsx(m,{children:e.jsx(x,{children:e.jsx("div",{className:"space-y-3",children:a.map(r=>e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.description}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Paid by ",d(r.paidByUserId)]}),r.createdAt&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:new Date(r.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:C(r.amount)}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[r.shares.length," ",r.shares.length===1?"person":"people"]})]})]})},r.id))})})})}function ge({groupId:s,group:t}){const[a,n]=k.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(pe,{groupId:s,group:t,isOpen:a,onToggle:()=>n(!a),onSuccess:()=>n(!1)}),e.jsx(ye,{groupId:s,group:t})]})}function je(s){return F({queryKey:["settlements",s],queryFn:async()=>(await N.get("/api/settlements",{params:{groupId:s}})).data,enabled:!!s})}function be(){const s=B();return P({mutationFn:async t=>(await N.post("/api/settlements",t)).data,onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["settlements",a.groupId]}),s.invalidateQueries({queryKey:["balances",a.groupId]}),w.success("Settlement recorded successfully")},onError:t=>{w.error(t.response?.data?.message||"Failed to record settlement")}})}function fe({groupId:s,group:t,isOpen:a,onToggle:n,onSuccess:c}){const d=be(),{register:r,handleSubmit:l,reset:i,formState:{errors:h}}=I({resolver:M(Y),defaultValues:{fromUserId:t.members[0]?.id||"",toUserId:t.members[1]?.id||"",amount:0}}),U=async u=>{await d.mutateAsync({groupId:s,fromUserId:u.fromUserId,toUserId:u.toUserId,amount:u.amount}),i(),c()};return e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Settlements"}),e.jsxs(y,{size:"sm",onClick:n,children:[a?e.jsx(R,{className:"mr-2 h-4 w-4"}):e.jsx(L,{className:"mr-2 h-4 w-4"}),a?"Cancel":"Record Settlement"]})]})}),a&&e.jsx(x,{children:e.jsxs("form",{onSubmit:l(U),className:"space-y-4",children:[e.jsx(S,{label:"From",options:t.members.map(u=>({value:u.id,label:u.name||u.email})),error:h.fromUserId?.message,...r("fromUserId")}),e.jsx(S,{label:"To",options:t.members.map(u=>({value:u.id,label:u.name||u.email})),error:h.toUserId?.message,...r("toUserId")}),e.jsx(f,{label:"Amount",type:"number",step:"0.01",placeholder:"0.00",error:h.amount?.message,...r("amount",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(y,{type:"submit",loading:d.isPending,children:"Record Settlement"})]})]})})]})}function Ne({groupId:s,group:t}){const{data:a,isLoading:n,error:c}=je(s);if(n)return e.jsx(v,{className:"py-12"});if(c)return e.jsx(m,{children:e.jsx(x,{children:e.jsx("p",{className:"text-center text-red-600",children:"Failed to load settlements"})})});if(!a||a.length===0)return e.jsx(m,{children:e.jsx(x,{children:e.jsx(A,{icon:e.jsx(le,{size:32}),title:"No settlements yet",description:"Record payments to settle balances"})})});const d=r=>{const l=t.members.find(i=>i.id===r);return l?.name||l?.email||"Unknown"};return e.jsx(m,{children:e.jsx(x,{children:e.jsx("div",{className:"space-y-3",children:a.map(r=>e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:d(r.fromUserId)}),e.jsx(ne,{className:"mx-2 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:d(r.toUserId)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:C(r.amount)}),r.createdAt&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:new Date(r.createdAt).toLocaleDateString()})]})]})},r.id))})})})}function ve({groupId:s,group:t}){const[a,n]=k.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(fe,{groupId:s,group:t,isOpen:a,onToggle:()=>n(!a),onSuccess:()=>n(!1)}),e.jsx(Ne,{groupId:s,group:t})]})}function Se(){const{groupId:s,tab:t="overview"}=ee(),a=se(),{data:n,isLoading:c,error:d}=T(s);if(c)return e.jsx(v,{className:"py-12"});if(d||!n)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-red-600",children:"Failed to load group details"})});const r=[{id:"overview",label:"Overview",content:e.jsx(xe,{groupId:s})},{id:"members",label:"Members",content:e.jsx(ue,{group:n})},{id:"expenses",label:"Expenses",content:e.jsx(ge,{groupId:s,group:n})},{id:"settlements",label:"Settlements",content:e.jsx(ve,{groupId:s,group:n})}];return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>a("/groups"),className:"mr-4",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:n.name})]})}),e.jsx(ce,{tabs:r,activeTab:t||"overview",onTabChange:l=>a(`/groups/${s}/${l}`)})]})}export{Se as GroupDetailLayout};
